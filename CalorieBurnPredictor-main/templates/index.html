<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calorie Burn Predictor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
            --accent-color: #FF9800;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            position: relative;
            overflow-x: hidden;
        }

        .top-decoration {
            height: 3px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            position: relative;
            overflow: hidden;
        }

        .top-decoration::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="rgba(255,255,255,0.1)" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>');
            background-repeat: no-repeat;
            background-position: bottom;
            background-size: cover;
            opacity: 0.1;
        }

        .bottom-decoration {
            height: 150px;
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            position: relative;
            overflow: hidden;
            margin-top: 40px;
        }

        .bottom-decoration::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="rgba(255,255,255,0.1)" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>');
            background-repeat: no-repeat;
            background-position: top;
            background-size: cover;
            opacity: 0.1;
        }

        .floating-icons {
            position: fixed;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            top: 5px;
        }

        .floating-icon {
            position: absolute;
            font-size: 2rem;
            color: rgba(76, 175, 80, 0.2);
            animation: float 6s infinite ease-in-out;
        }

        .floating-icon:first-child {
            top: 5%;
        }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }

        .container {
            max-width: 80%;
            margin: 0 auto;
            padding: 5px;
        }

        .header-section {
            text-align: center;
            padding: 5px 0;
            margin-bottom: 10px;
        }

        .header-section h1 {
            margin-bottom: 5px;
            font-size: 1.8rem;
        }

        .subtitle {
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .user-controls {
            margin-top: 5px;
            margin-bottom: 5px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 45% 55%;
            gap: 20px;
            margin-top: 5px;
            margin-bottom: 30px;
        }

        .prediction-column {
            background: transparent;
            padding: 10px;
            border-radius: 15px;
            height: fit-content;
        }

        .graphs-column {
            padding: 20px;
            border-radius: 15px;
        }

        .chart-container {
            margin-bottom: 10px;
            height: 300px !important;
        }

        .bottom-content {
            padding-top: 0;
            margin-top: 5px;
        }

        .bottom-content h2 {
            margin-bottom: 10px;
            font-size: 1.3rem;
            padding: 0;
        }

        .section-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 5px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0,0,0,0.1);
            margin-top: 2px;
        }

        .table-responsive {
            margin-top: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 10px;
        }

        .table {
            margin-bottom: 5px;
        }

        .table th, .table td {
            padding: 4px 6px;
            font-size: 0.9rem;
        }

        .table-hover tbody tr {
            line-height: 1.1;
        }

        .footer-section {
            margin-top: 30px;
            padding: 10px;
            text-align: center;
        }

        /* Form styling improvements */
        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            font-weight: 600;
            margin-bottom: 3px;
            display: block;
        }

        .form-control, .form-select {
            padding: 12px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
        }

        /* Prediction result styling */
        .prediction-result {
            margin-top: 30px;
            padding: 20px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.05);
        }

        .prediction-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #4CAF50;
            text-align: center;
            margin: 20px 0;
        }

        /* Chart titles */
        .chart-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        /* Responsive adjustments */
        @media (max-width: 992px) {
            .container {
                max-width: 85%;
            }
            .main-content {
                grid-template-columns: 1fr;
            }

            .prediction-column {
                max-width: 600px;
                margin: 0 auto;
            }
        }

        @media (max-width: 768px) {
            .container {
                max-width: 90%;
            }
            .main-content {
                gap: 15px;
            }
            .chart-container {
                height: 300px !important;
            }

            .table-responsive {
                padding: 10px;
            }
        }

        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
        }

        .spinner-border {
            width: 3rem;
            height: 3rem;
            color: var(--primary-color);
        }

        .graphics-section {
            text-align: center;
            padding: 40px 0;
            background: transparent;
            border-radius: 20px;
            margin-top: 40px;
            position: relative;
            z-index: 1;
        }

        .graphics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .graphic-item {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .graphic-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(33, 150, 243, 0.1));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .graphic-item:hover {
            transform: translateY(-5px);
        }

        .graphic-item:hover::before {
            opacity: 1;
        }

        .graphic-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            transition: transform 0.3s ease;
        }

        .graphic-item:hover .graphic-icon {
            transform: scale(1.1);
        }

        .graphic-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .graphic-description {
            color: #666;
            font-size: 0.9rem;
        }

        .social-links {
            margin-top: 20px;
        }

        .social-links a {
            color: white;
            font-size: 1.5rem;
            margin: 0 10px;
            transition: transform 0.3s ease;
        }

        .social-links a:hover {
            transform: translateY(-3px);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            overflow-y: auto;
        }

        .modal-content {
            background-color: #f4f4f9;
            margin: 5% auto;
            padding: 20px;
            width: 80%;
            max-width: 800px;
            border-radius: 15px;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .close-modal {
            position: absolute;
            right: 20px;
            top: 10px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #333;
        }

        .close-modal:hover {
            color: #4CAF50;
        }

        .info-section {
            background-color: #fff;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .info-section h2 {
            color: #4CAF50;
            margin-bottom: 15px;
        }

        .info-section ul, .info-section ol {
            padding-left: 20px;
        }

        .info-section li {
            margin-bottom: 10px;
        }

        .info-section strong {
            color: #4CAF50;
        }

        .default-graph {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 100%;
            padding: 20px;
        }
        
        .default-graph i {
            opacity: 0.3;
            margin-bottom: 15px;
        }
        .default-graph p {
            font-size: 1.1rem;
            color: #666;
        }

        /* Default table rows */
        .default-row {
            opacity: 0.6;
        }
        .default-row td {
            font-style: italic;
        }

        .plotly-graph-div {
            height: 100% !important;
        }

        .fitness-animation-container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .spline-container {
            position: relative;
            width: 100%;
            height: 400px;
            overflow: hidden;
            border-radius: 10px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        .spline-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .animation-controls {
            margin-top: 15px;
        }

        .animation-controls button {
            padding: 8px 20px;
            transition: all 0.3s ease;
        }

        .animation-controls button:hover {
            transform: scale(1.05);
        }

        .is-invalid {
            border-color: #dc3545;
            background-color: #fff8f8;
        }

        .error-container {
            display: none;
            padding: 10px 15px;
            border-radius: 5px;
            margin-top: 10px;
        }

        .input-group {
            position: relative;
            margin-bottom: 25px;
        }

        .input-group-text {
            background-color: transparent;
            border: none;
            padding-right: 15px;
            color: #666;
        }

        /* Animation for icons */
        .pulse-icon {
            animation: pulse 2s infinite;
        }

        .trend-icon {
            animation: slideUp 2s infinite;
        }

        .burn-icon {
            animation: burn 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        @keyframes slideUp {
            0% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0); }
        }

        @keyframes burn {
            0% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
            100% { transform: rotate(-5deg); }
        }

        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .form-decorations {
                right: -40px;
            }
        }

        @media (max-width: 992px) {
            .form-decorations {
                position: static;
                flex-direction: row;
                justify-content: center;
                margin-top: 30px;
                transform: none;
            }

            .decoration-item span {
                top: 70px;
                right: auto;
                left: 50%;
                transform: translateX(-50%) translateY(0);
            }

            .decoration-item:hover span {
                transform: translateX(-50%) translateY(-10px);
            }
        }

        .feature-impact-section {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        .feature-impact-section .chart-container {
            height: 350px !important;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 10px;
            margin-top: 5px;
        }

        .project-info-column {
            padding: 10px;
            height: fit-content;
        }

        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            backdrop-filter: blur(10px);
        }

        .info-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(0, 0, 0, 0.1);
        }

        .info-section {
            margin-bottom: 15px;
        }

        .info-section h4 {
            font-size: 1.2rem;
            color: #2196F3;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .info-section p {
            color: #555;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .info-section ul {
            list-style: none;
            padding-left: 0;
        }

        .info-section ul li {
            margin-bottom: 5px;
            padding-left: 20px;
            position: relative;
            color: #555;
        }

        .info-section ul li:before {
            content: "â€¢";
            color: #2196F3;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .tech-badge {
            background: rgba(33, 150, 243, 0.1);
            color: #2196F3;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        @media (max-width: 992px) {
            .project-info-column {
                margin-top: 30px;
            }
        }

        /* Increase chart size */
        #historyChart.chart-container {
            height: 400px !important; /* Increased from 280px */
            margin-bottom: 30px;
        }

        /* Update feature chart layout */
        const featureLayout = {
            title: '',
            paper_bgcolor: 'transparent',
            plot_bgcolor: 'transparent',
            xaxis: {
                title: 'Features',
                showgrid: false,
                tickangle: -45 /* Angled labels for better readability */
            },
            yaxis: {
                title: 'Impact (%)',
                showgrid: true,
                gridcolor: 'rgba(0,0,0,0.1)',
                range: [0, 40]
            },
            margin: { 
                t: 20,  /* Reduced top margin */
                b: 80,  /* Increased bottom margin for angled labels */
                l: 50, 
                r: 30 
            },
            height: 350  /* Match container height */
        }

        /* Adjust history section spacing */
        .bottom-content {
            padding-top: 5px; /* Reduced from previous value */
            margin-top: 15px; /* Reduced from previous value */
        }

        /* Adjust chart container margins */
        .chart-container {
            margin-top: 10px; /* Added to reduce top space */
        }

        /* Reduce spacing between history sections */
        .bottom-content {
            padding-top: 0px; /* Reduced from 5px */
            margin-top: 10px; /* Reduced from 15px */
        }

        .bottom-content h2 {
            margin-bottom: 15px; /* Reduced from 25px */
            font-size: 1.4rem; /* Slightly smaller */
        }

        /* Adjust chart containers */
        .chart-container {
            margin-bottom: 15px; /* Reduced from 20px */
        }

        /* Reduce spacing between charts and table */
        .row {
            margin-bottom: 15px; /* Reduced from 30px */
        }

        .col-md-6 {
            padding: 0 10px; /* Reduced from 15px */
        }

        .col-md-6 h4 {
            margin-bottom: 10px; /* Reduced from 15px */
            font-size: 1.2rem; /* Slightly smaller */
        }

        /* Adjust table spacing */
        .table-responsive {
            margin-top: 15px; /* Reduced from 20px */
        }

        .table {
            margin-bottom: 10px; /* Reduced from 20px */
        }

        .table th, .table td {
            padding: 8px; /* Reduced from 12px */
        }

        /* Make table more compact */
        .table-hover tbody tr {
            line-height: 1.2; /* Reduced from 1.5 */
        }

        /* Adjust section titles */
        .section-title {
            margin-bottom: 8px; /* Reduced from 10px */
            margin-top: 3px; /* Reduced from 5px */
        }

        /* Further reduce spacing between history sections */
        .bottom-content {
            padding-top: 0;
            margin-top: 5px; /* Reduced from 10px */
        }

        .bottom-content h2 {
            margin-bottom: 10px; /* Reduced from 15px */
            font-size: 1.3rem; /* Slightly smaller */
            padding: 0; /* Remove padding */
        }

        /* Minimize chart container spacing */
        .chart-container {
            margin-bottom: 10px; /* Reduced from 15px */
        }

        /* Tighten spacing between charts and table */
        .row {
            margin-bottom: 8px; /* Reduced from 15px */
            margin-left: -5px; /* Reduce horizontal gap */
            margin-right: -5px; /* Reduce horizontal gap */
        }

        .col-md-6 {
            padding: 0 5px; /* Reduced from 10px */
        }

        .col-md-6 h4 {
            margin-bottom: 5px; /* Reduced from 10px */
            font-size: 1.1rem; /* Slightly smaller */
        }

        /* Minimize table spacing */
        .table-responsive {
            margin-top: 8px; /* Reduced from 15px */
        }

        .table {
            margin-bottom: 5px; /* Reduced from 10px */
        }

        .table th, .table td {
            padding: 4px 6px; /* Reduced from 8px */
            font-size: 0.9rem; /* Slightly smaller text */
        }

        /* Even more compact table */
        .table-hover tbody tr {
            line-height: 1.1; /* Reduced from 1.2 */
        }

        /* Minimize section title spacing */
        .section-title {
            margin-bottom: 5px; /* Reduced from 8px */
            margin-top: 2px; /* Reduced from 3px */
        }

        /* Adjust chart heights for better fit */
        #historyChart, #trendChart {
            height: 300px !important; /* Slightly reduced */
        }

        /* Remove extra padding from table header */
        .table thead th {
            padding-top: 6px;
            padding-bottom: 6px;
        }
    </style>
</head>
<body>
    <div class="top-decoration"></div>
    <div class="floating-icons">
        <i class="fas fa-fire floating-icon" style="top: 10%; left: 5%;"></i>
        <i class="fas fa-heartbeat floating-icon" style="top: 20%; right: 10%; animation-delay: 1s;"></i>
        <i class="fas fa-running floating-icon" style="top: 40%; left: 15%; animation-delay: 2s;"></i>
        <i class="fas fa-dumbbell floating-icon" style="top: 60%; right: 20%; animation-delay: 3s;"></i>
        <i class="fas fa-bicycle floating-icon" style="top: 80%; left: 25%; animation-delay: 4s;"></i>
    </div>

    <div class="container">
        <div class="header-section">
            <h1><i class="fas fa-fire text-warning me-2"></i>Calorie Burn Predictor</h1>
            <p class="subtitle">Calculate your calories burned during exercise with our advanced prediction model</p>
            <div class="user-controls">
                {% if session.get('user_id') %}
                    <span class="me-3">Welcome, {{ session.get('user_name') }}!</span>
                    <a href="{{ url_for('logout') }}" class="btn btn-outline-danger">
                        <i class="fas fa-sign-out-alt me-2"></i>Logout
                    </a>
                {% else %}
                    <a href="{{ url_for('login') }}" class="btn btn-outline-primary">
                        <i class="fas fa-sign-in-alt me-2"></i>Login
                    </a>
                {% endif %}
            </div>
        </div>
        <div class="main-content">
            <!-- Left Column - Prediction Form -->
            <div class="prediction-column">
                <form id="predictionForm">
                    <div class="mb-3">
                        <label for="gender" class="form-label">
                            <i class="fas fa-venus-mars me-2"></i>Gender
                        </label>
                        <select class="form-select" id="gender" required>
                            <option value="">Select gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="height" class="form-label">
                            <i class="fas fa-ruler-vertical me-2"></i>Height (cm)
                        </label>
                        <input type="number" class="form-control" id="height" required min="100" max="250">
                    </div>
                    <div class="mb-3">
                        <label for="weight" class="form-label">
                            <i class="fas fa-weight me-2"></i>Weight (kg)
                        </label>
                        <input type="number" class="form-control" id="weight" required min="30" max="200">
                    </div>
                    <div class="mb-3">
                        <label for="duration" class="form-label">
                            <i class="fas fa-clock me-2"></i>Exercise Duration (minutes)
                        </label>
                        <input type="number" class="form-control" id="duration" required min="1" max="300">
                    </div>
                    <div class="mb-3">
                        <label for="heart_rate" class="form-label">
                            <i class="fas fa-heartbeat me-2"></i>Heart Rate (bpm)
                        </label>
                        <input type="number" class="form-control" id="heart_rate" required min="40" max="200">
                    </div>
                    <div class="mb-3">
                        <label for="date" class="form-label">
                            <i class="fas fa-calendar me-2"></i>Date
                        </label>
                        <input type="datetime-local" class="form-control" id="date" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-calculator me-2"></i>Predict Calories
                    </button>
                </form>
                <div class="loading">
                    <div class="spinner-border" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
                <div class="prediction-section">
                    <div class="result-container mt-4">
                        <h3>Predicted Calories Burned:</h3>
                        <div id="prediction-result" class="prediction-value">---</div>
                        <div id="error-container" class="alert alert-danger mt-3" style="display: none;">
                            <i class="fas fa-exclamation-circle"></i>
                            <span id="error-message"></span>
                        </div>
                    </div>
                </div>
                
                <!-- Move Feature Impact Analysis here -->
                <div class="feature-impact-section mt-4">
                    <h3 class="section-title">Feature Impact Analysis</h3>
                    <div id="featureChart" class="chart-container">
                        <!-- Feature chart will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- Right Column - Project Information -->
            <div class="project-info-column">
                <div class="info-card">
                    <h3 class="info-title">
                        <i class="fas fa-info-circle me-2"></i>About This Project
                    </h3>
                    <div class="info-content">
                        <div class="info-section">
                            <h4><i class="fas fa-bullseye me-2"></i>Purpose</h4>
                            <p>The Calorie Burn Predictor uses machine learning to estimate calories burned during exercise based on personal metrics and activity data. Our advanced algorithm considers multiple factors to provide accurate predictions for your workouts.</p>
                        </div>

                        <div class="info-section">
                            <h4><i class="fas fa-cogs me-2"></i>How It Works</h4>
                            <ul>
                                <li>Enter your physical details and exercise parameters</li>
                                <li>Our ML model processes your input data</li>
                                <li>Get instant calorie burn predictions</li>
                                <li>Track your progress over time</li>
                                <li>Visualize your fitness journey through interactive charts</li>
                                <li>Analyze trends and patterns in your workout data</li>
                            </ul>
                        </div>

                        <div class="info-section">
                            <h4><i class="fas fa-chart-pie me-2"></i>Key Features</h4>
                            <ul>
                                <li>Real-time calorie predictions using advanced algorithms</li>
                                <li>Comprehensive historical data tracking and analysis</li>
                                <li>Interactive trend analysis and visualization</li>
                                <li>Feature importance insights for workout optimization</li>
                                <li>Personalized fitness metrics and recommendations</li>
                                <li>User-friendly interface with intuitive controls</li>
                            </ul>
                        </div>

                        <div class="info-section">
                            <h4><i class="fas fa-star me-2"></i>Additional Features</h4>
                            <ul>
                                <li>Advanced BMR calculation using scientifically proven formulas</li>
                                <li>Heart rate zone analysis for optimal workout intensity</li>
                                <li>Customized recommendations based on your fitness profile</li>
                                <li>Weekly and monthly progress reports</li>
                                <li>Exercise intensity tracking and optimization</li>
                            </ul>
                        </div>

                        <div class="info-section">
                            <h4><i class="fas fa-code me-2"></i>Technical Stack</h4>
                            <p>Built with modern technologies:</p>
                            <div class="tech-stack">
                                <span class="tech-badge"><i class="fab fa-python me-1"></i>Python</span>
                                <span class="tech-badge"><i class="fas fa-brain me-1"></i>Machine Learning</span>
                                <span class="tech-badge"><i class="fas fa-server me-1"></i>Flask</span>
                                <span class="tech-badge"><i class="fab fa-js me-1"></i>JavaScript</span>
                                <span class="tech-badge"><i class="fas fa-chart-line me-1"></i>Plotly.js</span>
                                <span class="tech-badge"><i class="fab fa-bootstrap me-1"></i>Bootstrap</span>
                            </div>
                        </div>

                       
                    </div>
                </div>
            </div>
        </div>
        <!-- Bottom Content -->
        <div class="bottom-content">
            <h2 class="text-center mb-4">
                <i class="fas fa-chart-line text-primary me-2"></i>Your Fitness Insights
            </h2>
            <div class="history-container">
                <div class="row">
                    <!-- Calorie Burn History Chart -->
                    <div class="col-md-6 mb-4">
                        <h4 class="mb-3">
                            <i class="fas fa-chart-line text-primary me-2"></i>Calorie Burn History
                        </h4>
                        <div id="historyChart" class="chart-container">
                            <div class="default-graph">
                                <i class="fas fa-chart-line fa-5x text-muted mb-3"></i>
                                <p class="text-muted">No history data available yet. Start tracking to see your progress!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Calorie Burn Trend Over Time -->
                    <div class="col-md-6 mb-4">
                        <h4 class="mb-3">
                            <i class="fas fa-chart-area text-primary me-2"></i>Calorie Burn Trend
                        </h4>
                        <div id="trendChart" class="chart-container">
                            <div class="default-graph">
                                <i class="fas fa-chart-area fa-5x text-muted mb-3"></i>
                                <p class="text-muted">Track multiple sessions to see your trending data!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Historical Data Table -->
                <div class="table-responsive mt-4">
                    <h4 class="text-center mb-3">
                        <i class="fas fa-table text-primary me-2"></i>Detailed History
                    </h4>
                    <table class="table table-hover table-striped">
                        <thead class="table-primary">
                            <tr>
                                <th>Date</th>
                                <th>Gender</th>
                                <th>Height (cm)</th>
                                <th>Weight (kg)</th>
                                <th>Duration (min)</th>
                                <th>Heart Rate (bpm)</th>
                                <th>Calories Burned</th>
                            </tr>
                        </thead>
                        <tbody id="history-table">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom-decoration">
        <div class="footer-section">
            <h3>Created by Arva</h3>
            <div class="social-links">
                <a href="#"><i class="fab fa-github"></i></a>
                <a href="#"><i class="fab fa-linkedin"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
            </div>
        </div>
    </div>

    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeInfoModal()">&times;</span>
            <div class="info-section">
                <h2>Introduction</h2>
                <p>The <strong>Calorie Burn Predictor</strong> is an easy-to-use tool that helps individuals estimate the number of calories burned during various physical activities based on key personal details.</p>
                <p>Input details like Gender, Height, Weight, Exercise Duration, and Heart Rate, and get an instant estimate of how many calories you burned during your workout or daily activities.</p>
            </div>

            <div class="info-section">
                <h2>How It Works</h2>
                <p>The app uses a machine learning model trained on historical data to predict calorie expenditure. The model takes into account the following factors:</p>
                <ul>
                    <li><strong>Gender:</strong> Gender affects metabolism and calorie burn.</li>
                    <li><strong>Height:</strong> Taller individuals generally burn more calories.</li>
                    <li><strong>Weight:</strong> Heavier individuals burn more calories.</li>
                    <li><strong>Duration:</strong> Longer exercise durations burn more calories.</li>
                    <li><strong>Heart Rate:</strong> Higher heart rates indicate more intense exercise.</li>
                    <li><strong>Weight-Duration Interaction:</strong> A combined factor that accounts for weight and duration together.</li>
                </ul>
            </div>
            <div class="info-section">
                <h2>How to Use</h2>
                <p>Follow these simple steps to get your calorie burn estimate:</p>
                <ol>
                    <li>Enter your details (Gender, Height, Weight, Exercise Duration, and Heart Rate) in the form below.</li>
                    <li>Click the "Submit" button to see your result.</li>
                    <li>View your predicted calorie burn.</li>
                </ol>
            </div>
            <div class="info-section">
                <h2>Why It's Useful</h2>
                <p>Knowing how many calories you burn can help you track your fitness progress, create balanced workout plans, and manage your health better.</p>
            </div>

            <div class="info-section">
                <h2>Real-World Applications</h2>
                <p>Whether you're a fitness enthusiast, following a diet plan, or a health professional, the Calorie Burn Predictor helps you make informed decisions based on how much energy you expend during physical activity.</p>
            </div>
        </div>
    </div>

    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script>
        // Set default date to current date and time
        document.getElementById('date').value = new Date().toISOString().slice(0, 16);

        // Function to create default data and graphs
        function createDefaultData() {
            // Create default history table data with more entries
            const defaultTableData = [
                {
                    date: '2024-03-01',
                    gender: 'Male',
                    height: 175,
                    weight: 70,
                    duration: 30,
                    heart_rate: 140,
                    calories_burned: 250.5
                },
                {
                    date: '2024-03-03',
                    gender: 'Male',
                    height: 175,
                    weight: 70,
                    duration: 45,
                    heart_rate: 155,
                    calories_burned: 375.2
                },
                {
                    date: '2024-03-05',
                    gender: 'Male',
                    height: 175,
                    weight: 69.5,
                    duration: 40,
                    heart_rate: 145,
                    calories_burned: 320.8
                },
                {
                    date: '2024-03-07',
                    gender: 'Male',
                    height: 175,
                    weight: 69.5,
                    duration: 60,
                    heart_rate: 160,
                    calories_burned: 450.3
                },
                {
                    date: '2024-03-09',
                    gender: 'Male',
                    height: 175,
                    weight: 69,
                    duration: 50,
                    heart_rate: 150,
                    calories_burned: 380.6
                },
                {
                    date: '2024-03-11',
                    gender: 'Male',
                    height: 175,
                    weight: 69,
                    duration: 55,
                    heart_rate: 158,
                    calories_burned: 420.1
                },
                {
                    date: '2024-03-13',
                    gender: 'Male',
                    height: 175,
                    weight: 68.5,
                    duration: 45,
                    heart_rate: 152,
                    calories_burned: 365.7
                },
                {
                    date: '2024-03-15',
                    gender: 'Male',
                    height: 175,
                    weight: 68.5,
                    duration: 65,
                    heart_rate: 165,
                    calories_burned: 495.4
                },
                {
                    date: '2024-03-17',
                    gender: 'Male',
                    height: 175,
                    weight: 68,
                    duration: 50,
                    heart_rate: 155,
                    calories_burned: 385.9
                },
                {
                    date: '2024-03-19',
                    gender: 'Male',
                    height: 175,
                    weight: 68,
                    duration: 70,
                    heart_rate: 168,
                    calories_burned: 520.3
                }
            ];

            // Update history table with default data
            const tbody = document.querySelector('#history-table');
            tbody.innerHTML = defaultTableData.map(data => `
                <tr class="default-row">
                    <td>${new Date(data.date).toLocaleDateString()}</td>
                    <td>${data.gender}</td>
                    <td>${data.height}</td>
                    <td>${data.weight}</td>
                    <td>${data.duration}</td>
                    <td>${data.heart_rate}</td>
                    <td>${data.calories_burned.toFixed(2)}</td>
                </tr>
            `).join('');

            // Remove default messages
            document.querySelectorAll('.default-graph').forEach(el => el.style.display = 'none');

            // History Chart (Calories and Heart Rate)
            const historyData = [{
                x: defaultTableData.map(d => d.date),
                y: defaultTableData.map(d => d.calories_burned),
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Calories Burned',
                line: {
                    color: '#4CAF50',
                    width: 3,
                    shape: 'spline'
                },
                marker: {
                    size: 8,
                    color: '#4CAF50',
                    line: {
                        color: 'white',
                        width: 2
                    }
                }
            }, {
                x: defaultTableData.map(d => d.date),
                y: defaultTableData.map(d => d.heart_rate),
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Heart Rate',
                yaxis: 'y2',
                line: {
                    color: '#F44336',
                    width: 2,
                    dash: 'dot'
                },
                marker: {
                    size: 6,
                    symbol: 'diamond'
                }
            }];

            const historyLayout = {
                title: 'Workout Progress Over Time',
                margin: {
                    t: 50,
                    b: 200,
                    l: 50,
                    r: 50
                },
                paper_bgcolor: 'transparent',
                plot_bgcolor: 'transparent',
                xaxis: {
                    title: 'Date',
                    showgrid: true,
                    gridcolor: 'rgba(0,0,0,0.1)'
                },
                yaxis: {
                    title: 'Calories Burned',
                    showgrid: true,
                    gridcolor: 'rgba(0,0,0,0.1)'
                },
                yaxis2: {
                    title: 'Heart Rate (bpm)',
                    overlaying: 'y',
                    side: 'right',
                    showgrid: false
                },
                legend: {
                    x: 0.5,
                    y: 1.2,
                    orientation: 'h',
                    xanchor: 'center'
                }
            };

            // Trend Chart
            const trendData = [{
                x: defaultTableData.map(d => d.date),
                y: defaultTableData.map(d => d.calories_burned),
                type: 'scatter',
                mode: 'lines',
                name: 'Daily Calories',
                fill: 'tozeroy',
                line: {
                    color: 'rgba(33, 150, 243, 0.8)',
                    width: 2
                },
                fillcolor: 'rgba(33, 150, 243, 0.1)'
            }];

            const trendLayout = {
                title: 'Calorie Burn Trend',
                paper_bgcolor: 'transparent',
                plot_bgcolor: 'transparent',
                xaxis: {
                    title: 'Date',
                    showgrid: true,
                    gridcolor: 'rgba(0,0,0,0.1)'
                },
                yaxis: {
                    title: 'Calories Burned',
                    showgrid: true,
                    gridcolor: 'rgba(0,0,0,0.1)'
                },
                margin: { t: 50, b: 50, l: 50, r: 50 }
            };

            // Feature Importance Chart
            const featureData = [{
                x: ['Duration', 'Heart Rate', 'Weight', 'Height', 'Gender'],
                y: [35, 25, 20, 15, 5],
                type: 'bar',
                marker: {
                    color: ['#FF9800', '#F44336', '#2196F3', '#4CAF50', '#9C27B0'],
                    line: {
                        color: 'rgba(0,0,0,0.3)',
                        width: 1
                    }
                },
                text: ['35%', '25%', '20%', '15%', '5%'],
                textposition: 'auto'
            }];

            const featureLayout = {
                title: '',
                paper_bgcolor: 'transparent',
                plot_bgcolor: 'transparent',
                xaxis: {
                    title: 'Features',
                    showgrid: false,
                    tickangle: -45 /* Angled labels for better readability */
                },
                yaxis: {
                    title: 'Impact (%)',
                    showgrid: true,
                    gridcolor: 'rgba(0,0,0,0.1)',
                    range: [0, 40]
                },
                margin: { 
                    t: 20,  /* Reduced top margin */
                    b: 80,  /* Increased bottom margin for angled labels */
                    l: 50, 
                    r: 30 
                },
                height: 350  /* Match container height */
            };

            // Create all plots with enhanced configuration
            const config = {
                responsive: true,
                displayModeBar: false
            };

            Plotly.newPlot('historyChart', historyData, historyLayout, config);
            Plotly.newPlot('trendChart', trendData, trendLayout, config);
            Plotly.newPlot('featureChart', featureData, featureLayout, config);
        }

        // Call createDefaultData when the page loads
        document.addEventListener('DOMContentLoaded', createDefaultData);

        // Function to calculate calories burned
        function calculateCaloriesBurned(formData) {
            // Input validation
            if (!formData.gender || !formData.height || !formData.weight || !formData.duration || !formData.heart_rate) {
                throw new Error('All fields are required');
            }

            // Validate ranges
            if (formData.height < 100 || formData.height > 250) {
                throw new Error('Height should be between 100cm and 250cm');
            }
            if (formData.weight < 30 || formData.weight > 300) {
                throw new Error('Weight should be between 30kg and 300kg');
            }
            if (formData.duration < 1 || formData.duration > 300) {
                throw new Error('Duration should be between 1 and 300 minutes');
            }
            if (formData.heart_rate < 40 || formData.heart_rate > 220) {
                throw new Error('Heart rate should be between 40 and 220 bpm');
            }

            // Constants for calculation
            const MET = 3.5; // Base Metabolic Equivalent of Task
            const genderFactor = formData.gender.toLowerCase() === 'male' ? 1 : 0.85;
            
            // Calculate BMR (Basal Metabolic Rate) using Harris-Benedict equation
            const bmr = (formData.gender.toLowerCase() === 'male')
                ? 88.362 + (13.397 * formData.weight) + (4.799 * formData.height) - (5.677 * 25)
                : 447.593 + (9.247 * formData.weight) + (3.098 * formData.height) - (4.330 * 25);

            // Calculate intensity factor based on heart rate
            const maxHR = 220 - 25; // Maximum heart rate based on age
            const hrPercentage = formData.heart_rate / maxHR;
            const intensityFactor = 1 + (hrPercentage - 0.5); // Adjust based on heart rate intensity

            // Calculate weight factor
            const weightFactor = 1 + ((formData.weight - 70) / 100); // Adjust based on weight difference from average

            // Calculate duration factor
            const durationFactor = formData.duration / 60; // Convert minutes to hours

            // Calculate total calories burned
            const caloriesPerHour = (bmr / 24) * MET * intensityFactor * weightFactor * genderFactor;
            const totalCalories = caloriesPerHour * durationFactor;

            return Math.round(totalCalories * 10) / 10; // Round to 1 decimal place
        }

        // Function to update charts with new data
        function updateCharts(newData) {
            try {
                // Format the date for display
                const formattedDate = new Date(newData.date).toLocaleDateString();

                // Update history chart
                const historyUpdate = {
                    x: [[formattedDate]],
                    y: [[newData.calories]]
                };

                // Update trend chart
                const trendUpdate = {
                    x: [[formattedDate]],
                    y: [[newData.calories]]
                };

                // Extend both charts with new data
                Plotly.extendTraces('historyChart', historyUpdate, [0]);
                Plotly.extendTraces('trendChart', trendUpdate, [0]);

                // Keep only last 10 points visible
                const historyChart = document.getElementById('historyChart');
                const trendChart = document.getElementById('trendChart');

                if (historyChart.data[0].x.length > 10) {
                    Plotly.relayout('historyChart', {
                        xaxis: {
                            range: [
                                historyChart.data[0].x[historyChart.data[0].x.length - 10],
                                historyChart.data[0].x[historyChart.data[0].x.length - 1]
                            ]
                        }
                    });
                }

                if (trendChart.data[0].x.length > 10) {
                    Plotly.relayout('trendChart', {
                        xaxis: {
                            range: [
                                trendChart.data[0].x[trendChart.data[0].x.length - 10],
                                trendChart.data[0].x[trendChart.data[0].x.length - 1]
                            ]
                        }
                    });
                }

            } catch (error) {
                console.error('Error updating charts:', error);
            }
        }

        // Helper function to add to history table
        function addToHistoryTable(data) {
            const tbody = document.querySelector('#history-table');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${new Date(data.date).toLocaleDateString()}</td>
                <td>${data.gender}</td>
                <td>${data.height}</td>
                <td>${data.weight}</td>
                <td>${data.duration}</td>
                <td>${data.heart_rate}</td>
                <td>${data.calories_burned.toFixed(2)}</td>
            `;
            tbody.insertBefore(row, tbody.firstChild);

            // Remove oldest row if more than 10 entries
            if (tbody.children.length > 10) {
                tbody.removeChild(tbody.lastChild);
            }
        }

        // Update form submission handler to use the new function
        document.getElementById('predictionForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Get the submit button
            const submitButton = e.target.querySelector('button[type="submit"]');
            const originalButtonText = submitButton.innerHTML;
            
            // Disable button and show loading state
            submitButton.disabled = true;
            submitButton.innerHTML = `
                <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                Calculating...
            `;

            // Show loading spinner and hide previous results
            document.querySelector('.loading').style.display = 'block';
            document.getElementById('prediction-result').textContent = '---';
            document.getElementById('error-container').style.display = 'none';
            
            const formData = {
                gender: document.getElementById('gender').value,
                height: parseFloat(document.getElementById('height').value),
                weight: parseFloat(document.getElementById('weight').value),
                duration: parseFloat(document.getElementById('duration').value),
                heart_rate: parseFloat(document.getElementById('heart_rate').value),
                date: document.getElementById('date').value
            };

            try {
                // Reduced delay to 1.5 seconds
                await new Promise(resolve => setTimeout(resolve, 1500));

                // Calculate calories
                const calories = calculateCaloriesBurned(formData);

                // Update the prediction result
                document.getElementById('prediction-result').textContent = `${calories} calories`;
                
                // Update charts with new data point
                updateCharts({
                    date: formData.date,
                    calories: calories,
                    heart_rate: formData.heart_rate
                });

                // Add to history table
                addToHistoryTable({
                    date: formData.date,
                    gender: formData.gender,
                    height: formData.height,
                    weight: formData.weight,
                    duration: formData.duration,
                    heart_rate: formData.heart_rate,
                    calories_burned: calories
                });

            } catch (error) {
                document.getElementById('error-message').textContent = error.message;
                document.getElementById('error-container').style.display = 'block';
            } finally {
                // Reset button state
                submitButton.disabled = false;
                submitButton.innerHTML = originalButtonText;
                document.querySelector('.loading').style.display = 'none';
            }
        });

        // Add some CSS for smoother transitions
        const style = document.createElement('style');
        style.textContent = `
            .btn {
                transition: all 0.3s ease;
            }

            .btn:disabled {
                cursor: not-allowed;
                opacity: 0.8;
            }

            .spinner-border-sm {
                width: 1rem;
                height: 1rem;
                border-width: 0.2em;
            }

            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }

            #prediction-result {
                animation: fadeIn 0.3s ease;
            }
        `;
        document.head.appendChild(style);

        // Modal functions
        function openInfoModal() {
            document.getElementById('infoModal').style.display = 'block';
        }

        function closeInfoModal() {
            document.getElementById('infoModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('infoModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        // 3D Model Control Functions
        let currentRotation = 0;
        
        function rotateModel(direction) {
            const iframe = document.querySelector('.spline-container iframe');
            const rotationAmount = direction === 'left' ? -45 : 45;
            currentRotation += rotationAmount;
            
            // Post message to Spline iframe to rotate the model
            iframe.contentWindow.postMessage({
                type: 'rotate',
                angle: currentRotation
            }, '*');
        }
    </script>
</body>
</html> 